L.WebGLHeatMap=L.Renderer.extend({version:"0.2.7",options:{size:30000,units:"m",opacity:1,gradientTexture:false,alphaRange:1,padding:0},_initContainer:function(){var a=this._container=L.DomUtil.create("canvas","leaflet-zoom-animated"),b=this.options;a.id="webgl-leaflet-"+L.Util.stamp(this);a.style.opacity=b.opacity;a.style.position="absolute";try{this.gl=window.createWebGLHeatmap({canvas:a,gradientTexture:b.gradientTexture,alphaRange:[0,b.alphaRange]})}catch(c){console.error(c);this.gl={clear:function(){},update:function(){},multiply:function(){},addPoint:function(){},display:function(){},adjustSize:function(){}}}this._container=a},onAdd:function(){this.size=this.options.size;L.Renderer.prototype.onAdd.call(this);this.resize()},_destroyContainer:function(){delete this.gl;L.DomUtil.remove(this._container);L.DomEvent.off(this._container);delete this._container},getEvents:function(){var a=L.Renderer.prototype.getEvents.call(this);L.Util.extend(a,{resize:this.resize,move:L.Util.throttle(this._update,49,this)});return a},resize:function(){var a=this._container,b=this._map.getSize();a.width=b.x;a.height=b.y;this.gl.adjustSize();this.draw()},reposition:function(){var a=this._map._getMapPanePos().multiplyBy(-1);L.DomUtil.setPosition(this._container,a)},_update:function(){L.Renderer.prototype._update.call(this);this.draw()},draw:function(){var a=this._map,k=this.gl,e=this.data,d=e.length,g=Math.floor,l=this["_scale"+this.options.units].bind(this),b=this._multiply;if(!a){return}k.clear();this.reposition();if(d){for(var f=0;f<d;f++){var j=e[f],c=L.latLng(j),h=a.latLngToContainerPoint(c);k.addPoint(g(h.x),g(h.y),l(c),j[2])}k.update();if(b){k.multiply(b);k.update()}}k.display()},_scalem:function(f){var c=this._map,e=(this.size/40075017)*360/Math.cos((Math.PI/180)*f.lat),d=new L.LatLng(f.lat,f.lng-e),a=c.latLngToLayerPoint(f),b=c.latLngToLayerPoint(d);return Math.max(Math.round(a.x-b.x),1)},_scalepx:function(){return this.size},data:[],addDataPoint:function(b,c,a){this.data.push([b,c,a/100])},setData:function(a){this.data=a;this._multiply=null;this.draw()},clear:function(){this.setData([])},multiply:function(a){this._multiply=a;this.draw()}});L.webGLHeatmap=function(a){return new L.WebGLHeatMap(a)};